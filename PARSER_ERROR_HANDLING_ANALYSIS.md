# –ê–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ czbooks_parser.py

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞**: 2025-11-18
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ Chrome

---

## 1. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –æ—à–∏–±–∫–∏

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π:

```
[2025-11-18 07:05:55,485]  ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (270448 —Å–∏–º–≤–æ–ª–æ–≤, 4279 –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤)
[2025-11-18 07:05:55,575]     üìù –ò–∑–≤–ª–µ—á–µ–Ω–æ —Å—Ç—Ä–æ–∫ —Å <br>: 102 (4306 —Å–∏–º–≤–æ–ª–æ–≤)
[2025-11-18 07:05:55,576]  ‚úÖ –ì–ª–∞–≤–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞: 4306 —Å–∏–º–≤–æ–ª–æ–≤
[2025-11-18 07:05:55,612]  üìÑ –ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–∞–≤—ã: https://czbooks.net/n/u9l2l/u961j
[2025-11-18 07:05:55,612]  üåê –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: https://czbooks.net/n/u9l2l/u961j
[2025-11-18 07:05:56,270]     ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è Cloudflare (18.3s)...
[2025-11-18 07:06:14,613]     ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞: .chapter-content, #content, article, main
[2025-11-18 07:06:34,857]  ‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞: Message:
```

**Timeline**:
- 07:05:55.612 - –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–π –≥–ª–∞–≤—ã
- 07:05:56.270 - driver.get() –≤—ã–ø–æ–ª–Ω–µ–Ω, –Ω–∞—á–∞–ª–æ –æ–∂–∏–¥–∞–Ω–∏—è Cloudflare
- 07:06:14.613 - Cloudflare –ø—Ä–æ–π–¥–µ–Ω (18.3s), –Ω–∞—á–∞–ª–æ –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞
- 07:06:34.857 - **TIMEOUT** (20 —Å–µ–∫—É–Ω–¥ –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞)

**–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç**:
1. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å (driver.get() —É—Å–ø–µ—à–µ–Ω)
2. ‚úÖ Cloudflare –ø—Ä–æ–π–¥–µ–Ω (18.3s –æ–∂–∏–¥–∞–Ω–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫)
3. ‚ùå –°–µ–ª–µ–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ `.chapter-content, #content, article, main` –Ω–µ –Ω–∞–π–¥–µ–Ω –∑–∞ 20 —Å–µ–∫—É–Ω–¥
4. ‚ùì **–ù–ï–¢ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –∏–ª–∏ retry**

---

## 2. –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ - –ö–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–∫–∏

### –ü—Ä–æ–±–ª–µ–º–Ω–æ–µ –º–µ—Å—Ç–æ: `_get_page_with_selenium()`, —Å—Ç—Ä–æ–∫–∏ 626-636

```python
# –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Å–µ–ª–µ–∫—Ç–æ—Ä, –∂–¥–µ–º –µ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è
if wait_selector:
    try:
        print(f"   ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞: {wait_selector}")
        WebDriverWait(self.driver, wait_time).until(
            EC.presence_of_element_located((By.CSS_SELECTOR, wait_selector))
        )
        print(f"   ‚úÖ –≠–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω")
    except Exception as e:
        print(f"   ‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞: {e}")
        # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–∞–∂–µ –µ—Å–ª–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω  ‚Üê ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #1
```

**–ü–†–û–ë–õ–ï–ú–ê #1**: Exception –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏ **–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è**
- –ü—Ä–∏ `TimeoutException` –æ—Ç `WebDriverWait`:
  - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
  - **–ö–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –¥–µ–π—Å—Ç–≤–∏–π
  - –ù–ï–¢ retry
  - –ù–ï–¢ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
  - –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–∞–ª—å—à–µ (—Å—Ç—Ä–æ–∫–∏ 637-798):

```python
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Cloudflare challenge
page_source = self.driver.page_source

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–æ—à–ª–∏ –ª–∏ –º—ã Cloudflare (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫)
max_attempts = self.cloudflare_max_attempts
for attempt in range(max_attempts):
    cf_indicators = [...]

    if any(cf_indicators):
        wait_time = 20 + (attempt * 10)
        time.sleep(wait_time)
        page_source = self.driver.page_source
    else:
        break  # Cloudflare –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω - –≤—ã—Ö–æ–¥–∏–º
```

**–ü–†–û–ë–õ–ï–ú–ê #2**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ Cloudflare, –ù–ï –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ü–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ Cloudflare indicators
- –ï—Å–ª–∏ Cloudflare –ù–ï –æ–±–Ω–∞—Ä—É–∂–µ–Ω (–∞ –æ–Ω —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω —Ä–∞–Ω–µ–µ):
  - –¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è (`break`)
  - –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ

### –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 771-797):

```python
# –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: —Ä–∞–∑–º–µ—Ä –ò –Ω–∞–ª–∏—á–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
page_size = len(page_source)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ czbooks
chinese_chars = len([c for c in page_source if '\u4e00' <= c <= '\u9fff'])
has_chapter_content = any([
    '<div class="chapter-content"' in page_source,
    '<div class="novel-content"' in page_source,
    chinese_chars > 500,
])

if page_size > 5000 and has_chapter_content:
    print(f"   ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ ({page_size} —Å–∏–º–≤–æ–ª–æ–≤, {chinese_chars} –∫–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤)")
    self.consecutive_errors = 0
    return page_source
elif page_size > 5000:
    # –ë–æ–ª—å—à–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ë–ï–ó —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    print(f"   ‚ö†Ô∏è –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ ({page_size} —Å–∏–º–≤–æ–ª–æ–≤), –Ω–æ –ù–ï–¢ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
    self.consecutive_errors += 1
    # –ü—Ä–æ–±—É–µ–º –≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫ –µ—Å—Ç—å - –º–æ–∂–µ—Ç –ø–∞—Ä—Å–µ—Ä —Å–ø—Ä–∞–≤–∏—Ç—Å—è  ‚Üê ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #3
    return page_source
```

**–ü–†–û–ë–õ–ï–ú–ê #3**: –í–æ–∑–≤—Ä–∞—Ç –ø—É—Å—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–º–µ—Å—Ç–æ retry –∏–ª–∏ restart
- –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ >5000 —Å–∏–º–≤–æ–ª–æ–≤ –ë–ï–ó —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:
  - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è `consecutive_errors`
  - **–ù–û —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å!**
  - –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ `consecutive_errors >= N` –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
  - –ù–ï–¢ retry –∑–∞–≥—Ä—É–∑–∫–∏
  - –ù–ï–¢ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞

---

## 3. –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞

### –ì–¥–µ –ï–°–¢–¨ –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:

#### 3.1. –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 606-611):

```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–µ–Ω –ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞
self.request_count += 1
if self.request_count >= self.max_requests_before_restart:  # max = 100
    print(f"   üìä –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ ({self.request_count}/{self.max_requests_before_restart})")
    self.restart_driver()
```

**–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**: –ö–∞–∂–¥—ã–µ 100 –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏)

#### 3.2. –ü—Ä–∏ Connection refused (—Å—Ç—Ä–æ–∫–∏ 799-810):

```python
except Exception as e:
    print(f"   ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: {e}")
    self.consecutive_errors += 1

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–º–µ—Ä –ª–∏ –±—Ä–∞—É–∑–µ—Ä (Connection refused)
    error_str = str(e)
    if 'Connection refused' in error_str or 'NewConnectionError' in error_str:
        print(f"   üî• –ë—Ä–∞—É–∑–µ—Ä –º–µ—Ä—Ç–≤ (Connection refused) - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫...")
        self.restart_driver(force_kill_chrome=True)

    raise
```

**–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**: –ö–æ–≥–¥–∞ Selenium –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Chrome (–±—Ä–∞—É–∑–µ—Ä –º–µ—Ä—Ç–≤)

### –ì–¥–µ –ù–ï–¢ –ª–æ–≥–∏–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:

‚ùå **–ü—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞** (—Å—Ç—Ä–æ–∫–∞ 633)
‚ùå **–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ** (—Å—Ç—Ä–æ–∫–∞ 793)
‚ùå **–ü—Ä–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ consecutive_errors** (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!)
‚ùå **–ü—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –º–∞–ª–æ–º —Ä–∞–∑–º–µ—Ä–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** (—Å—Ç—Ä–æ–∫–∞ 796)

---

## 4. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è consecutive_errors - "–ú–µ—Ä—Ç–≤–∞—è" –ª–æ–≥–∏–∫–∞

### –ì–¥–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è:

1. **–°—Ç—Ä–æ–∫–∞ 717**: –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è Cloudflare ‚Üí `self.consecutive_errors = 0` (—Å–±—Ä–æ—Å)
2. **–°—Ç—Ä–æ–∫–∞ 762**: –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä—É—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è Cloudflare ‚Üí `self.consecutive_errors = 0` (—Å–±—Ä–æ—Å)
3. **–°—Ç—Ä–æ–∫–∞ 768**: –ü—Ä–∏ –Ω–µ—É–¥–∞—á–µ —Ä—É—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è ‚Üí `self.consecutive_errors += 1`
4. **–°—Ç—Ä–æ–∫–∞ 784**: –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ ‚Üí `self.consecutive_errors = 0` (—Å–±—Ä–æ—Å)
5. **–°—Ç—Ä–æ–∫–∞ 791**: –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –±–æ–ª—å—à–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ ‚Üí `self.consecutive_errors += 1`
6. **–°—Ç—Ä–æ–∫–∞ 796**: –ü—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –º–∞–ª–æ–º —Ä–∞–∑–º–µ—Ä–µ ‚Üí `self.consecutive_errors += 1`
7. **–°—Ç—Ä–æ–∫–∞ 801**: –ü—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ ‚Üí `self.consecutive_errors += 1`

### –ì–¥–µ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:

‚ùå **–ù–ò–ì–î–ï!** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–æ–ª—å–∫–æ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, –Ω–æ **–ù–ò–ö–û–ì–î–ê –ù–ï –ü–†–û–í–ï–†–Ø–ï–¢–°–Ø** –¥–ª—è –∫–∞–∫–∏—Ö-–ª–∏–±–æ –¥–µ–π—Å—Ç–≤–∏–π!

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

- **–°—Ç—Ä–æ–∫–∞ 1257**: `_delay_between_requests()` - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–∞—É–∑—É –Ω–∞ –æ—Å–Ω–æ–≤–µ `consecutive_errors`

```python
def _delay_between_requests(self):
    base_delay = 3.0

    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø–∞—É–∑—É –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
    if self.consecutive_errors > 0:
        base_delay *= (1 + self.consecutive_errors * 0.5)

    # –ú–∞–∫—Å–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥
    base_delay = min(base_delay, 30.0)

    print(f"‚è≥ –ü–∞—É–∑–∞ {delay:.1f}s (–æ—à–∏–±–æ–∫: {self.consecutive_errors})...")
    time.sleep(delay)
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–∞—É–∑—ã —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è, –Ω–æ **–±—Ä–∞—É–∑–µ—Ä –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –¥–∞–∂–µ –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö!

---

## 5. –°—Ü–µ–Ω–∞—Ä–∏–π –≤ –Ω–∞—à–∏—Ö –ª–æ–≥–∞—Ö

### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:

1. **–ì–ª–∞–≤–∞ N —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞** (270448 —Å–∏–º–≤–æ–ª–æ–≤, 4279 –∫–∏—Ç–∞–π—Å–∫–∏—Ö)
   - `consecutive_errors = 0` (—Å–±—Ä–æ—à–µ–Ω –ø—Ä–∏ —É—Å–ø–µ—Ö–µ)

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–∞–≤—ã N+1**:
   - `driver.get(url)` - —É—Å–ø–µ—à–Ω–æ
   - –û–∂–∏–¥–∞–Ω–∏–µ Cloudflare 18.3s - —É—Å–ø–µ—à–Ω–æ
   - **–û–∂–∏–¥–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞** - TimeoutException (20s)

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞**:
   - Exception –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 633)
   - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: `‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞`
   - **–ö–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** (–ù–ï–¢ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏!)

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ Cloudflare**:
   - `page_source = self.driver.page_source`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ `cf_indicators` - –≤—Å–µ False (Cloudflare —É–∂–µ –ø—Ä–æ–π–¥–µ–Ω)
   - –¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è (`break`)

5. **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**:
   - `page_size > 5000`? –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –î–ê
   - `has_chapter_content`? –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –ù–ï–¢ (—Å–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω!)
   - **–ü–æ–ø–∞–¥–∞–µ–º –≤ –±–ª–æ–∫ —Å—Ç—Ä–æ–∫ 786-793**:
     ```python
     elif page_size > 5000:
         print(f"   ‚ö†Ô∏è –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–æ –ù–ï–¢ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
         self.consecutive_errors += 1  # –¢–µ–ø–µ—Ä—å = 1
         return page_source  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É!
     ```

6. **get_chapter_content() –ø–æ–ª—É—á–∞–µ—Ç HTML –ë–ï–ó –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≥–ª–∞–≤—ã**:
   - `_extract_chapter_content()` –∏—â–µ—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
   - –°–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç "Content not found" –∏–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç

7. **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
   - –ì–ª–∞–≤–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ "–∑–∞–≥—Ä—É–∂–µ–Ω–∞" —Å –ø—É—Å—Ç—ã–º/–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
   - **–ë—Ä–∞—É–∑–µ—Ä –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
   - `consecutive_errors = 1` (–ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∏–≥–¥–µ!)
   - –ü–∞—Ä—Å–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –≥–ª–∞–≤—ã —Å **–¢–ï–ú –ñ–ï –º–µ—Ä—Ç–≤—ã–º/–∑–∞–≤–∏—Å—à–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –±—Ä–∞—É–∑–µ—Ä–∞**

---

## 6. –ü–æ—á–µ–º—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ë–ï–ó –∫–æ–Ω—Ç–µ–Ω—Ç–∞?

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **–ë—Ä–∞—É–∑–µ—Ä –≤ –∑–∞–≤–∏—Å—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏**:
   - Chrome –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–∏—Å –∏–ª–∏ —á–∞—Å—Ç–∏—á–Ω–æ –º–µ—Ä—Ç–≤
   - JavaScript –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é

2. **–ù–µ–ø–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ DOM**:
   - `driver.get()` –≤–µ—Ä–Ω—É–ª—Å—è –¥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
   - AJAX –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å

3. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∞–π—Ç–∞**:
   - czbooks.net –∏–∑–º–µ–Ω–∏–ª —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
   - –ù–æ–≤—ã–π HTML layout
   - –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞ –Ω–æ–≤—ã–º anti-bot –º–µ—Ö–∞–Ω–∏–∑–º–æ–º

4. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Å—Å–∏–µ–π**:
   - Cookies —É—Å—Ç–∞—Ä–µ–ª–∏/–∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã
   - –°–µ—Å—Å–∏—è –ø—Ä–µ—Ä–≤–∞–Ω–∞
   - –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

5. **Memory leak –∏–ª–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞**:
   - Chrome –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏ –ø–æ—Å–ª–µ N –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ë—Ä–∞—É–∑–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ
   - –¢–∞–π–º–∞—É—Ç–æ–≤ 20s –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

### –ö–∞–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

**–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–¥ –ø–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞**:

```python
except Exception as e:
    print(f"   ‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞: {e}")

    # –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê
    page_source = self.driver.page_source
    print(f"   üìä –†–∞–∑–º–µ—Ä page_source: {len(page_source)}")
    print(f"   üìä –ö–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤: {len([c for c in page_source if '\u4e00' <= c <= '\u9fff'])}")
    print(f"   üìÑ –ü—Ä–µ–≤—å—é HTML (–ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤):")
    print(f"   {page_source[:500]}")

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª–Ω—ã–π HTML –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    debug_file = f"/tmp/czbooks_timeout_debug_{int(time.time())}.html"
    with open(debug_file, 'w', encoding='utf-8') as f:
        f.write(page_source)
    print(f"   üíæ –ü–æ–ª–Ω—ã–π HTML —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {debug_file}")
```

---

## 7. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–π–º–∞—É—Ç–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞:

```python
# –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Å–µ–ª–µ–∫—Ç–æ—Ä, –∂–¥–µ–º –µ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è
if wait_selector:
    try:
        print(f"   ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞: {wait_selector}")
        WebDriverWait(self.driver, wait_time).until(
            EC.presence_of_element_located((By.CSS_SELECTOR, wait_selector))
        )
        print(f"   ‚úÖ –≠–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω")

    except Exception as e:
        print(f"   ‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞: {e}")

        # –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        page_source = self.driver.page_source
        page_size = len(page_source)
        chinese_chars = len([c for c in page_source if '\u4e00' <= c <= '\u9fff'])

        print(f"   üìä –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã: {page_size}, –ö–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤: {chinese_chars}")

        # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏
        self.consecutive_errors += 1

        # –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê: –ï—Å–ª–∏ 3+ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—à–∏–±–∫–∏
        if self.consecutive_errors >= 3:
            print(f"\n{'='*60}")
            print(f"   üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø")
            print(f"   –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫: {self.consecutive_errors}")
            print(f"   –ü—Ä–∏—á–∏–Ω–∞: –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
            print(f"   –î–µ–π—Å—Ç–≤–∏–µ: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Chrome")
            print(f"{'='*60}\n")

            # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å force_kill (—É–±–∏–≤–∞–µ–º –∑–∞–≤–∏—Å—à–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã)
            self.restart_driver(force_kill_chrome=True)

            # Retry –¢–ï–ö–£–©–ï–ô —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
            print(f"   üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞...")
            return self._get_page_with_selenium(url, wait_selector, wait_time)

        # –ï—Å–ª–∏ <3 –æ—à–∏–±–æ–∫: –ø—Ä–æ–±—É–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        if page_size < 5000 or chinese_chars < 100:
            print(f"   ‚ùå –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—É—Å—Ç–∞—è –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–∞—è")
            print(f"   üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ retry...")
            self.restart_driver(force_kill_chrome=True)
            return self._get_page_with_selenium(url, wait_selector, wait_time)

        # –ò–Ω–∞—á–µ: –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
        print(f"   ‚ö†Ô∏è –°–µ–ª–µ–∫—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –ø—É—Å—Ç–∞—è - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º...")
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

#### 1. –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ consecutive_errors:

```python
# –í –Ω–∞—á–∞–ª–µ _get_page_with_selenium() –ü–ï–†–ï–î request_count –ø—Ä–æ–≤–µ—Ä–∫–æ–π
if self.consecutive_errors >= 5:
    print(f"   üî• –ù–∞–∫–æ–ø–ª–µ–Ω–æ {self.consecutive_errors} –æ—à–∏–±–æ–∫ - –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫")
    self.restart_driver(force_kill_chrome=True)
```

#### 2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ:

```python
elif page_size > 5000:
    print(f"   ‚ö†Ô∏è –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ ({page_size} —Å–∏–º–≤–æ–ª–æ–≤), –Ω–æ –ù–ï–¢ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞")
    print(f"   üìä –ö–∏—Ç–∞–π—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤: {chinese_chars}")

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º HTML –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
    debug_file = f"/tmp/czbooks_no_content_{int(time.time())}.html"
    with open(debug_file, 'w', encoding='utf-8') as f:
        f.write(page_source[:10000])  # –ü–µ—Ä–≤—ã–µ 10KB
    print(f"   üíæ HTML —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {debug_file}")

    self.consecutive_errors += 1

    # –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    if self.consecutive_errors >= 3:
        print(f"   üî• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞")
        self.restart_driver(force_kill_chrome=True)
        return self._get_page_with_selenium(url, wait_selector, wait_time)

    # –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–∑—É - retry
    print(f"   üîÑ Retry —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...")
    time.sleep(5)
    return self._get_page_with_selenium(url, wait_selector, wait_time)
```

#### 3. –ó–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ retry:

```python
def _get_page_with_selenium(self, url: str, wait_selector: str = None, wait_time: int = 15,
                            _retry_count: int = 0) -> str:
    """
    _retry_count: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)
    """
    MAX_RETRIES = 3

    if _retry_count >= MAX_RETRIES:
        print(f"   ‚ùå –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç retry ({MAX_RETRIES}), –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å")
        return self.driver.page_source if self.driver else ""

    # ... –≤–µ—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...

    # –ü—Ä–∏ retry:
    return self._get_page_with_selenium(url, wait_selector, wait_time, _retry_count + 1)
```

---

## 8. –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. ‚ùå **–¢–∞–π–º–∞—É—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è** - –∫–æ–¥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –±–µ–∑ retry/restart
2. ‚ùå **consecutive_errors –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** - –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
3. ‚ùå **–í–æ–∑–≤—Ä–∞—Ç –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü** - —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ë–ï–ó –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –ø–∞—Ä—Å–µ—Ä
4. ‚ùå **–ù–µ—Ç –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏** - –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è HTML –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
5. ‚ùå **–ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è** - –±—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –±–∏—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ

### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:

- **–ü–æ—Ç–µ—Ä—è –≥–ª–∞–≤**: –ì–ª–∞–≤—ã –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ "–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ" —Å –ø—É—Å—Ç—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- **–î–µ–≥—Ä–∞–¥–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞**: –ü–∞—Ä—Å–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- **–ù–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è**: –ë–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Å–∏—Ç—É–∞—Ü–∏—è –Ω–µ —É–ª—É—á—à–∞–µ—Ç—Å—è
- **–°–ª–æ–∂–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –ù–µ—Ç –ª–æ–≥–æ–≤/—Ñ–∞–π–ª–æ–≤ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **HIGH**: –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∞–π–º–∞—É—Ç–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —Å restart/retry
2. **HIGH**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å consecutive_errors –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ restart
3. **MEDIUM**: –°–æ—Ö—Ä–∞–Ω—è—Ç—å HTML –¥–µ–±–∞–≥ —Ñ–∞–π–ª—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
4. **MEDIUM**: –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ retry
5. **LOW**: –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏

---

## 9. –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –≠—Ç–∞–ø 1: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Quick Fix)

**–§–∞–π–ª**: `parsers/sources/czbooks_parser.py`
**–°—Ç—Ä–æ–∫–∏**: 626-636

```python
except Exception as e:
    print(f"   ‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞: {e}")
    self.consecutive_errors += 1

    # –ï—Å–ª–∏ 3+ –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥ - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
    if self.consecutive_errors >= 3:
        print(f"   üî• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ({self.consecutive_errors} –æ—à–∏–±–æ–∫) - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Chrome")
        self.restart_driver(force_kill_chrome=True)
```

### –≠—Ç–∞–ø 2: –ü–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Complete Fix)

–°–º. —Ä–∞–∑–¥–µ–ª 7 "–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ"

### –≠—Ç–∞–ø 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö restart —Å–æ–±—ã—Ç–∏–π
- –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ consecutive_errors
- –ê–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö HTML —Ñ–∞–π–ª–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ success rate –ø–∞—Ä—Å–∏–Ω–≥–∞

---

**–ö–æ–Ω–µ—Ü –∞–Ω–∞–ª–∏–∑–∞**
