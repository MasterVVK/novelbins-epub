#!/usr/bin/env python3

import sys
import os
sys.path.append('/home/user/novelbins-epub/web_app')

from app import create_app, db
from app.models import PromptTemplate

app = create_app()

with app.app_context():
    template = PromptTemplate.query.get(1)
    
    new_prompt = """Ты работаешь с китайской веб-новеллой, переведенной на английский язык. Текст на английском языке.

Извлеки из английского текста ТОЛЬКО НОВЫЕ элементы (которых нет в глоссарии):

1. ПЕРСОНАЖИ - только имена людей, титулы (максимум 3-4 слова)
2. ЛОКАЦИИ - названия мест, городов, священных земель (максимум 3-4 слова)  
3. ТЕРМИНЫ - техники культивации, уровни силы (максимум 2-3 слова)
4. ТЕХНИКИ - боевые приемы, заклинания (максимум 3-4 слова)
5. АРТЕФАКТЫ - оружие, сокровища, реликвии (максимум 3-4 слова)

ФОРМАТ ОТВЕТА:
ПЕРСОНАЖИ:
- English Name = Русское Имя

ЛОКАЦИИ:
- English Location = Русская Локация

ТЕРМИНЫ:
- English Term = Русский Термин

ТЕХНИКИ:
- English Technique = Русская Техника

АРТЕФАКТЫ:
- English Artifact = Русский Артефакт

Если в какой-то категории нет новых элементов, напиши "нет новых".

ВАЖНО:
- Извлекай английские термины из текста и переводи их на русский
- НЕ извлекай обычные слова или предложения
- НЕ извлекай термины длиннее 4-5 слов
- Проверяй, что термина нет в существующем глоссарии
- Используй точные переводы, соответствующие контексту"""

    template.terms_extraction_prompt = new_prompt
    db.session.commit()
    print("✅ Промпт для извлечения терминов обновлен!") 