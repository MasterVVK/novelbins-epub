#!/usr/bin/env python3
"""
Тест перевода для проверки шаблона ISSTH с китайскими терминами
"""

import json

# Тестовый китайский текст с типичными элементами ISSTH
test_chinese_text = """第一章 学者孟浩

孟浩坐在山洞里，看了看身边的小胖子一眼。他们两人都是靠山宗的外门弟子，正在大青山上修炼。

"我们的修炼已经到了凝气第三层，"孟浩说道，他的声音中带着一丝疲惫，"但是想要筑基，还需要更多的灵石。"

小胖子点了点头，脸上露出担忧的表情："孟浩，我们去靠山宗的藏经阁看看吧，那里有很多修真功法。听说王腾飞已经快要突破到凝气第九层了。"

两人离开了山洞，向南域的靠山宗走去。路上，孟浩拿出了他的铜镜，这是他唯一的法宝。铜镜表面泛着淡淡的光芒，似乎蕴含着某种神秘的力量。

"这个世界的天道很神秘，"孟浩自言自语，他的眼中闪过一丝坚定，"我一定要走上修真之路，成为真正的修士！总有一天，我要封印这片天地！"

就在这时，他的丹田内突然传来一阵温热，真元在经脉中流转，神识也变得更加清晰。

"师兄，你看！"小胖子指着远处的靠山宗山门，"长老们似乎在准备什么仪式。"

孟浩凝神望去，只见几位筑基期的长老正在布置阵法，而宗主则站在最中央，手持一件散发着强大威压的仙器。

"那是...炼丹大会！"孟浩眼睛一亮，"如果能得到一颗筑基丹，我们就能突破到筑基期了！"

天空中突然响起轰鸣声，一道天劫的气息从远处传来。看来有人正在突破元婴期，引来了天劫的考验。

"修真之路，逆天而行，"孟浩握紧了铜镜，"我孟浩，定要在这条道路上走到最后！"

许师姐从远处走来，她是内门弟子中的佼佼者："孟师弟，王师兄正在找你，似乎与东荒的消息有关。"

孟浩心中一动，东荒是南域之外的神秘之地，传说那里有通往仙界的道路。也许，这就是他改变命运的机会。"""

# 期望的正确翻译示例（部分）
expected_translation_sample = """Учёный Мэн Хао

Мэн Хао сидел в пещере и взглянул на Толстяка рядом с собой. Они оба были внешними учениками секты Каошань и культивировали на горе Дацин.

"Наша культивация уже достигла третьего слоя Конденсации ци," сказал Мэн Хао, в его голосе слышалась усталость, "но чтобы достичь Создания основы, нужно больше духовных камней."

Толстяк кивнул, на его лице появилось беспокойство: "Мэн Хао, давай сходим в Павильон писаний секты Каошань, там много техник культивации истины. Я слышал, Ван Тэнфэй уже близок к прорыву в девятый слой Конденсации ци."
"""

# Ключевые проверки
print("🧪 ТЕСТ ПЕРЕВОДА ISSTH С КИТАЙСКИМИ ТЕРМИНАМИ")
print("=" * 60)
print()

print("📝 КЛЮЧЕВЫЕ ЭЛЕМЕНТЫ ДЛЯ ПРОВЕРКИ:")
print()

# Загружаем глоссарий
with open('/home/user/novelbins-epub/issth_glossary_chinese.json', 'r', encoding='utf-8') as f:
    glossary = json.load(f)

# Проверяем важные термины
test_terms = [
    ("孟浩", "Мэн Хао", "Главный герой"),
    ("小胖子", "Толстяк", "Друг ГГ"),
    ("靠山宗", "секта Каошань", "Основная секта"),
    ("大青山", "гора Дацин", "Локация"),
    ("凝气", "Конденсация ци", "1-й уровень"),
    ("筑基", "Создание основы", "2-й уровень"),
    ("元婴", "Изначальная душа", "4-й уровень"),
    ("灵石", "духовные камни", "Валюта"),
    ("铜镜", "медное зеркало", "Артефакт ГГ"),
    ("天道", "Небесное Дао", "Философия"),
    ("丹田", "поле киноварь", "Энергоцентр"),
    ("真元", "истинная изначальная энергия", "Энергия"),
    ("长老", "старейшина", "Иерархия"),
    ("天劫", "небесное бедствие", "Испытание"),
    ("仙界", "мир бессмертных", "Высший мир"),
    ("东荒", "Восточная пустошь", "Локация"),
]

print("✅ ПРАВИЛЬНЫЕ ПЕРЕВОДЫ:")
for chinese, russian, desc in test_terms:
    print(f"  {chinese} → {russian} ({desc})")

print()
print("❌ НЕДОПУСТИМЫЕ ВАРИАНТЫ:")
print("  - Meng Hao, Little Fatty (английские имена)")
print("  - 看了孟 Хао一眼 (смешанный текст)")
print("  - Большая Зелёная Гора (дословный перевод)")
print("  - Толстяк / Пухлик (варианты через /)")

print()
print("📋 КРИТЕРИИ УСПЕШНОГО ПЕРЕВОДА:")
print("  1. ВСЕ китайские символы переведены на русский")
print("  2. Имена транскрибированы по системе Палладия")
print("  3. Термины соответствуют глоссарию")
print("  4. Сохранена структура и поэтичность")
print("  5. Нет смешанного китайско-русского текста")

print()
print("💡 ИСПОЛЬЗОВАНИЕ:")
print("  1. Запустите перевод этого текста через систему")
print("  2. Проверьте результат по критериям выше")
print("  3. Убедитесь в консистентности терминологии")

print()
print("📄 Тестовый текст сохранен в переменной 'test_chinese_text'")
print("✅ Готово к тестированию!")